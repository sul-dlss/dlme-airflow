metadata:
  version: 1
  data_path: qnl
  schedule: "40 11 * * *"
sources:
  qnl:
    driver: oai_xml
    args:
      collection_url: https://api.qdl.qa/api/oaipmh
      metadata_prefix: mods_no_ocr
      wait: 2
      allow_expiration: true
      start_date: "2019-10-15T00:00:00Z"
      end_date: "2020-10-15T19:00:00Z"
    metadata:
      record_count_formula: /2
      data_path: qnl/british_library_combined
      post_harvest: "merge_records"
      config: qnl
      fields:
        id:
          path: "//header:identifier"
          namespace:
            header: "http://www.openarchives.org/OAI/2.0/"
          optional: true
        author:
          path: "//mods:namePart[../mods:role/mods:roleTerm='author']"
          namespace:
            mods: "http://www.loc.gov/mods/v3"
          optional: false
        shown_at:
          path: ".//mods:location/mods:url[not(@access = 'preview')]"
          namespace:
            mods: "http://www.loc.gov/mods/v3"
          optional: false
        preview:
          path: ".//mods:location/mods:url[@access = 'preview']"
          namespace:
            mods: "http://www.loc.gov/mods/v3"
          optional: false
        title_alternative:
          path: "//mods:titleInfo[@type = 'alternative']/mods:title"
          namespace:
            mods: "http://www.loc.gov/mods/v3"
          optional: false
        title:
          path: "//mods:titleInfo[not(ancestor::mods:relatedItem)]/mods:title"
          namespace:
            mods: "http://www.loc.gov/mods/v3"
          optional: false
